var P=(t,e)=>{let s=Math.ceil(Math.min(t,e)),o=Math.floor(Math.max(t,e)),n=Math.random()*(o-s+1)+s;return Math.floor(n)},h=t=>t[P(0,t.length-1)],S=t=>t.key==="Escape",g=t=>t.key==="Enter",y=(t,e=500)=>{let s;return(...o)=>{clearTimeout(s),s=setTimeout(()=>t.apply(void 0,o),e)}};var f=10,x=500;var r=document.querySelector(".big-picture"),A=r.querySelector(".big-picture__img img"),I=r.querySelector(".likes-count"),b=r.querySelector(".social__caption"),O=r.querySelector(".social__comment-shown-count"),w=r.querySelector(".social__comment-total-count"),L=r.querySelector(".social__comments"),u=r.querySelector(".comments-loader"),d=[],l=0,T=0,U=({avatar:t,message:e,name:s})=>{let o=document.createElement("li");o.classList.add("social__comment"),o.innerHTML='<img class="social__picture"><p class="social__text"></p>';let n=o.querySelector(".social__picture");n.src=t.replace("img/","images/"),n.alt=s,n.width=35,n.height=35;let i=o.querySelector(".social__text");return i.textContent=e,o},B=()=>{l<T?u.classList.remove("hidden"):u.classList.add("hidden")},G=()=>{O.textContent=l},C=()=>{let t=document.createDocumentFragment();d.splice(0,5).forEach(e=>{t.append(U(e)),l++}),L.append(t),B(),G()},q=({likes:t,comments:e,url:s,description:o})=>{A.src=`images/${s}`,A.alt=o,I.textContent=t,b.textContent=o,w.textContent=e.length,d.length=0,l=0,d.push(...e.slice()),L.innerHTML="",T=e.length,C()};u.addEventListener("click",C);var p=document.querySelector(".big-picture"),R=p.querySelector(".cancel"),M=t=>{p.classList.remove("hidden"),document.body.classList.add("modal-open"),document.addEventListener("keydown",D),q(t)},_=()=>{p.classList.add("hidden"),document.body.classList.remove("modal-open"),document.removeEventListener("keydown",D)};function D(t){S(t)&&(t.preventDefault(),_())}R.addEventListener("click",()=>{_()});R.addEventListener("keydown",t=>{g(t)&&_()});var v=document.querySelector(".pictures"),z=document.querySelector("#picture").content.querySelector(".picture"),E=[],K=()=>{document.querySelectorAll(".picture").forEach(t=>t.remove())},a=t=>{K(),E.length=0,E.push(...t.slice());let e=document.createDocumentFragment();t.forEach(({id:s,url:o,description:n,likes:i,comments:N})=>{let m=z.cloneNode(!0);m.querySelector(".picture__img").src=`images/${o}`,m.querySelector(".picture__img").alt=n,m.querySelector(".picture__likes").textContent=i,m.querySelector(".picture__comments").textContent=N.length,m.dataset.marker=s,e.appendChild(m)}),v.append(e)};v.addEventListener("click",t=>{let e=t.target.closest(".picture");if(e){let s=Number(e.dataset.marker),o=E.find(n=>n.id===s);M(o)}});var c=document.querySelector(".img-filters"),W=c.querySelector(".img-filters__form"),V=c.querySelector("#filter-default"),X=c.querySelector("#filter-random"),$=c.querySelector("#filter-discussed"),ut=()=>{c.classList.remove("img-filters--inactive")},Y=t=>{c.querySelector(".img-filters__button--active").classList.remove("img-filters__button--active"),t.classList.add("img-filters__button--active")},j=t=>{a(t)},J=t=>{let e=[];for(;e.length!==f;){let s=h(t);e.includes(s)||e.push(s)}a(e)},Q=t=>{let o=t.map(n=>({id:n.id,comments:n.comments.length})).sort((n,i)=>n.comments>i.comments?-1:n.comments<i.comments?1:0).map(n=>t[n.id]);a(o)},dt=t=>{W.addEventListener("click",y(e=>{e.target===V&&j(t),e.target===X&&J(t),e.target===$&&Q(t)},x))};c.addEventListener("click",t=>{t.target.classList.contains("img-filters__button")&&Y(t.target)});export{dt as onFilterClick,ut as showFilters};
